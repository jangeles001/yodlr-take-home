<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>User Profile</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB"
      crossorigin="anonymous"
    />
  </head>
  <body>
    <div class="text-center">
      <h1 class="mt-5 mb-3" id="header"></h1>
      <div class="row justify-content-center" id="account-info"></div>
      <p>
        <a class="mt-3 d-inline-block" href="/index.html">Home</a>
      </p>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
      (async () => {
        const header = document.getElementById("header");
        const accountInfo = document.getElementById("account-info");
        const userId = window.location.href.split("/").pop();

        try {
          const res = await fetch(`/users/${userId}`, {
            method: "GET",
            headers: { "Content-Type": "application/json" },
          });

          const response = await res.json();
          for (const [key, value] of Object.entries(response)) {
            const information = document.createElement("div");
            information.setAttribute("class", "row justify-content-center");
            const field = document.createElement("div");
            field.setAttribute("class", "col-sm-2 text-start border");
            const entry = document.createElement("div");
            entry.setAttribute("class", "col-sm-3 text-start border");
            field.textContent = `${key}:`;
            entry.textContent = `${value}`;
            information.appendChild(field);
            information.appendChild(entry);
            accountInfo.appendChild(information);
          }
          header.textContent = `Hello ${response.firstName} ${response.lastName}`;
        } catch (error) {
          console.log(error.message);
        }
      })();
    </script>
  </body>
</html>
